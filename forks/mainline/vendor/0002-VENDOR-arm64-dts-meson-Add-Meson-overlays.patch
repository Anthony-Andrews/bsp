From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Yuntian Zhang <yt@radxa.com>
Date: Mon, 23 May 2022 15:36:50 +0800
Subject: [PATCH] VENDOR: arm64: dts: meson: Add Meson overlays

Signed-off-by: Yuntian Zhang <yt@radxa.com>
---
 arch/arm64/boot/dts/amlogic/Makefile          |   2 +
 arch/arm64/boot/dts/amlogic/overlays/Makefile |  39 +++
 .../amlogic/overlays/README.meson-overlays    | 224 ++++++++++++++++++
 .../boot/dts/amlogic/overlays/meson-fixup.scr | Bin 0 -> 863 bytes
 .../dts/amlogic/overlays/meson-fixup.scr-cmd  |  17 ++
 ...meson-g12a-i2c-ao-m0-gpioao-2-gpioao-3.dts |  15 ++
 .../meson-g12a-i2c-ee-m1-gpioh-6-gpioh-7.dts  |  15 ++
 ...meson-g12a-i2c-ee-m1-gpiox-10-gpiox-11.dts |  15 ++
 ...meson-g12a-i2c-ee-m3-gpioa-14-gpioa-15.dts |  15 ++
 .../overlays/meson-g12a-pwm-c-on-gpiox-8.dts  |  17 ++
 .../meson-g12a-pwmao-a-on-gpioao-11.dts       |  17 ++
 .../overlays/meson-g12a-spi-spidev.dts        |  38 +++
 ...on-g12a-uart-ao-a-on-gpioao-0-gpioao-1.dts |  15 ++
 ...on-g12a-uart-ao-b-on-gpioao-2-gpioao-3.dts |  15 ++
 ...on-g12a-uart-ao-b-on-gpioao-8-gpioao-9.dts |  15 ++
 .../amlogic/overlays/meson-g12a-uart-ee-c.dts |  15 ++
 .../overlays/meson-g12a-w1-gpioao-3.dts       |  20 ++
 .../meson-g12b-i2c-ee-m0-gpioz-0-1.dts        |  15 ++
 .../meson-g12b-i2c-ee-m0-gpioz-1-7.dts        |  15 ++
 .../meson-g12b-i2c-ee-m1-gpioh-6-7.dts        |  15 ++
 .../meson-g12b-i2c-ee-m3-gpioa-14-15.dts      |  15 ++
 .../overlays/meson-g12b-pwm-b-gpioh-7.dts     |  17 ++
 .../overlays/meson-g12b-pwm-b-gpioz-0.dts     |  17 ++
 .../overlays/meson-g12b-pwm-c-d-gpioz-1-2.dts |  17 ++
 .../overlays/meson-g12b-pwm-c-gpioz-1.dts     |  17 ++
 .../overlays/meson-g12b-pwm-d-gpioz-2.dts     |  17 ++
 .../overlays/meson-g12b-pwm-f-gpioh-5.dts     |  17 ++
 .../meson-g12b-spi-b-gpioh-4-5-6-7.dts        |  23 ++
 .../meson-g12b-uart-ao-a-gpioao-0-1.dts       |  15 ++
 .../meson-g12b-uart-ao-b-gpioao-8-9.dts       |  15 ++
 .../meson-g12b-uart-ee-c-gpioh-4-5-6-7.dts    |  15 ++
 31 files changed, 724 insertions(+)
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/Makefile
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/README.meson-overlays
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-fixup.scr
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-fixup.scr-cmd
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12a-i2c-ao-m0-gpioao-2-gpioao-3.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12a-i2c-ee-m1-gpioh-6-gpioh-7.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12a-i2c-ee-m1-gpiox-10-gpiox-11.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12a-i2c-ee-m3-gpioa-14-gpioa-15.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12a-pwm-c-on-gpiox-8.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12a-pwmao-a-on-gpioao-11.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12a-spi-spidev.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12a-uart-ao-a-on-gpioao-0-gpioao-1.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12a-uart-ao-b-on-gpioao-2-gpioao-3.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12a-uart-ao-b-on-gpioao-8-gpioao-9.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12a-uart-ee-c.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12a-w1-gpioao-3.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12b-i2c-ee-m0-gpioz-0-1.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12b-i2c-ee-m0-gpioz-1-7.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12b-i2c-ee-m1-gpioh-6-7.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12b-i2c-ee-m3-gpioa-14-15.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-b-gpioh-7.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-b-gpioz-0.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-c-d-gpioz-1-2.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-c-gpioz-1.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-d-gpioz-2.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-f-gpioh-5.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12b-spi-b-gpioh-4-5-6-7.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12b-uart-ao-a-gpioao-0-1.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12b-uart-ao-b-gpioao-8-9.dts
 create mode 100644 arch/arm64/boot/dts/amlogic/overlays/meson-g12b-uart-ee-c-gpioh-4-5-6-7.dts

diff --git a/arch/arm64/boot/dts/amlogic/Makefile b/arch/arm64/boot/dts/amlogic/Makefile
index c65266d26..df219a9c4 100644
--- a/arch/arm64/boot/dts/amlogic/Makefile
+++ b/arch/arm64/boot/dts/amlogic/Makefile
@@ -58,3 +58,5 @@ dtb-$(CONFIG_ARCH_MESON) += meson-sm1-odroid-c4.dtb
 dtb-$(CONFIG_ARCH_MESON) += meson-sm1-x96-air-gbit.dtb
 dtb-$(CONFIG_ARCH_MESON) += meson-a1-ad401.dtb
 dtb-$(CONFIG_ARCH_MESON) += meson-s4-s805x2-aq222.dtb
+
+subdir-y += overlays
\ No newline at end of file
diff --git a/arch/arm64/boot/dts/amlogic/overlays/Makefile b/arch/arm64/boot/dts/amlogic/overlays/Makefile
new file mode 100644
index 000000000..3448b41cf
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/Makefile
@@ -0,0 +1,39 @@
+# SPDX-License-Identifier: GPL-2.0
+dtbo-$(CONFIG_ARCH_MESON) += \
+	meson-g12a-i2c-ao-m0-gpioao-2-gpioao-3.dtbo \
+	meson-g12a-i2c-ee-m1-gpioh-6-gpioh-7.dtbo \
+	meson-g12a-i2c-ee-m1-gpiox-10-gpiox-11.dtbo \
+	meson-g12a-i2c-ee-m3-gpioa-14-gpioa-15.dtbo \
+	meson-g12a-pwmao-a-on-gpioao-11.dtbo \
+	meson-g12a-pwm-c-on-gpiox-8.dtbo \
+	meson-g12a-spi-spidev.dtbo \
+	meson-g12a-uart-ao-a-on-gpioao-0-gpioao-1.dtbo \
+	meson-g12a-uart-ao-b-on-gpioao-2-gpioao-3.dtbo \
+	meson-g12a-uart-ao-b-on-gpioao-8-gpioao-9.dtbo \
+	meson-g12a-uart-ee-c.dtbo \
+	meson-g12a-w1-gpioao-3.dtbo \
+	meson-g12b-i2c-ee-m0-gpioz-0-1.dtbo \
+	meson-g12b-i2c-ee-m0-gpioz-1-7.dtbo \
+	meson-g12b-i2c-ee-m1-gpioh-6-7.dtbo \
+	meson-g12b-i2c-ee-m3-gpioa-14-15.dtbo \
+	meson-g12b-pwm-b-gpioh-7.dtbo \
+	meson-g12b-pwm-b-gpioz-0.dtbo \
+	meson-g12b-pwm-c-gpioz-1.dtbo \
+	meson-g12b-pwm-d-gpioz-2.dtbo \
+	meson-g12b-pwm-c-d-gpioz-1-2.dtbo \
+	meson-g12b-pwm-f-gpioh-5.dtbo \
+	meson-g12b-spi-b-gpioh-4-5-6-7.dtbo \
+	meson-g12b-uart-ao-a-gpioao-0-1.dtbo \
+	meson-g12b-uart-ao-b-gpioao-8-9.dtbo \
+	meson-g12b-uart-ee-c-gpioh-4-5-6-7.dtbo
+
+scr-$(CONFIG_ARCH_MESON) += \
+	meson-fixup.scr
+
+dtbotxt-$(CONFIG_ARCH_MESON) += \
+	README.meson-overlays
+
+targets += $(dtbo-y) $(scr-y) $(dtbotxt-y)
+
+always			:= $(dtbo-y) $(scr-y) $(dtbotxt-y)
+clean-files		:= *.dtbo *.scr
diff --git a/arch/arm64/boot/dts/amlogic/overlays/README.meson-overlays b/arch/arm64/boot/dts/amlogic/overlays/README.meson-overlays
new file mode 100644
index 000000000..e04eeb148
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/README.meson-overlays
@@ -0,0 +1,224 @@
+## Introduction
+
+This document describes overlays provided in the kernel packages.
+For generic device tree overlays documentation please see
+https://wiki.radxa.com/Device-tree-overlays
+
+## Platform and Chips
+
+Amlogic
+- meson-g12a / S905Y2
+- meson-g12b / A311D
+
+### g12a
+
+#### usage
+
+Kernel provided DT overlay files are in
+  /boot/dtbs/$(uname -r)/amlogic/overlays/
+
+/boot/uEnv.txt contents:
+
+overlays=meson-g12a-i2c-ao-m0-gpioao-2-gpioao-3 meson-g12a-i2c-ee-m1-gpioh-6-gpioh-7 meson-g12a-i2c-ee-m3-gpioa-14-gpioa-15 meson-g12a-spi-spidev
+param_spidev_spi_bus=0
+param_spidev_max_freq=10000000
+
+Add names of overlays you want to activate to overlays= line in /boot/uEnv.txt, separated with spaces.
+Add required parameters with their values to /boot/uEnv.txt, one per line.
+Add optional parameters with their values to /boot/uEnv.txt if you want to change the default value, one per line.
+
+#### Meson Overlay details:
+
+- meson-g12a-i2c-ao-m0-gpioao-2-gpioao-3 meson-g12a-i2c-ee-m1-gpioh-6-gpioh-7 meson-g12a-i2c-ee-m1-gpiox-10-gpiox-11 meson-g12a-i2c-ee-m3-gpioa-14-gpioa-15
+- meson-g12a-pwmao-a-on-gpioao-11 meson-g12a-pwm-c-on-gpiox-8
+- meson-g12a-spi-spidev
+- meson-g12a-uart-ao-a-on-gpioao-0-gpioao-1 meson-g12a-uart-ao-b-on-gpioao-2-gpioao-3 meson-g12a-uart-ao-b-on-gpioao-8-gpioao-9 meson-g12a-uart-ee-c
+
+#### meson-g12a-i2c-ee-m1-gpioh-6-gpioh-7
+
+Activates I2C EE M1
+
+Device name: /dev/i2c-1
+
+Pins (SCL, SDA): GPIOH_7, GPIOH_6
+
+Usage: add one line in /boot/uEnv.txt
+overlays=meson-g12a-i2c-ee-m1-gpioh-6-gpioh-7
+
+#### meson-g12a-i2c-ee-m1-gpiox-10-gpiox-11
+
+Activates I2C EE M1
+
+Device name: /dev/i2c-1
+
+Pins (SCL, SDA): GPIOX_11, GPIOX_10
+
+Usage: add one line in /boot/uEnv.txt
+overlays=meson-g12a-i2c-ee-m1-gpiox-10-gpiox-11
+
+#### meson-g12a-i2c-ee-m3-gpioa-14-gpioa-15
+
+Activates I2C EE M3
+
+Device name: /dev/i2c-3
+
+Pins (SCL, SDA): GPIOA_15, GPIOA_14
+
+Usage: add one line in /boot/uEnv.txt
+overlays=meson-g12a-i2c-ee-m3-gpioa-14-gpioa-15
+
+#### meson-g12a-i2c-ao-m0-gpioao-2-gpioao-3
+
+Activates I2C AO M0
+
+Device name: /dev/i2c-4
+
+Pins (SCL, SDA): GPIOAO_2, GPIOAO_3
+
+Usage: add one line in /boot/uEnv.txt
+overlays=meson-g12a-i2c-ao-m0-gpioao-2-gpioao-3
+
+#### meson-g12a-uart-ao-a-on-gpioao-0-gpioao-1
+
+Activates UART AO A (/dev/ttyAML0)
+
+pins (RX, TX): GPIOAO_1, GPIOAO_0
+
+Usage: add one line in /boot/uEnv.txt
+overlays=meson-g12a-uart-ao-a-on-gpioao-0-gpioao-1
+
+This dtbo meson-g12a-uart-ao-a-on-gpioao-0-gpioao-1 enables us to use /dev/ttyAML0 as serial console or common serial communication.
+
+For usage of serial console, add the following lines to /boot/uEnv.txt
+
+console=ttyAML0,115200
+overlays=meson-g12a-uart-ao-a-on-gpioao-0-gpioao-1
+
+For usage of common serial communication, add the following line to /boot/uEnv.txt
+
+overlays=meson-g12a-uart-ao-a-on-gpioao-0-gpioao-1
+
+#### meson-g12a-uart-ao-b-on-gpioao-2-gpioao-3
+
+Activates UART AO B (/dev/ttyAML1)
+
+pins (RX, TX): GPIOAO_3, GPIOAO_2
+
+Usage: add one line in /boot/uEnv.txt
+overlays=meson-g12a-uart-ao-b-on-gpioao-2-gpioao-3
+
+#### meson-g12a-uart-ao-b-on-gpioao-8-gpioao-9
+
+Activates UART AO B (/dev/ttyAML1)
+
+pins (RX, TX): GPIOAO_9, GPIOAO_8
+
+Usage: add one line in /boot/uEnv.txt
+overlays=meson-g12a-uart-ao-b-on-gpioao-8-gpioao-9
+
+#### meson-g12a-uart-ee-c
+
+Activates UART EE C (/dev/ttyAML4)
+
+pins (RX, TX, RTS, CTS): GPIOH_6, GPIOH_7, GPIOH_4, GPIOH_5
+
+Usage: add one line in /boot/uEnv.txt
+overlays=meson-g12a-uart-ee-c
+
+#### meson-g12a-pwm-c-on-gpiox-8
+
+Activates PWM_C
+
+Pins: GPIOX_8
+
+#### meson-g12a-pwmao-a-on-gpioao-11
+
+Activates PWMAO_A
+
+Pins: GPIOAO_11
+
+#### meson-g12a-spi-spidev
+
+Activates SPIdev device node (/dev/spidevX.Y) for userspace SPI access,
+where X is the bus number and Y is the CS number
+
+SPI A bus
+    pins (SS0, SCLK, MOSI, MISO): GPIOX_10, GPIOX_11, GPIOX_8, GPIOX_9
+    device: /dev/spidev0.0
+
+SPI B bus
+    pins (SS0, SCLK, MOSI, MISO): GPIOH_6, GPIOH_7, GPIOH_4, GPIOH_5
+    device: /dev/spidev1.0
+
+Parameters:
+
+param_spidev_spi_bus (int)
+    SPI bus to activate SPIdev support on
+    Required
+    Supported values: 0, 1
+
+param_spidev_spi_cs (int)
+    SPI chip select number
+    Optional
+    Default: 0
+    Supported values: 0
+
+param_spidev_max_freq (int)
+    Maximum SPIdev frequency
+    Optional
+    Default: 10000000
+    Range: 3000 - 100000000
+
+### g12b
+
+#### Usage
+
+Kernel provided DT overlay files are in `/boot/dtbs/$(uname -r)/amlogic/overlays`
+
+`/boot/uEnv.txt` syntax:
+
+    overlays=<space-seprated-list-of-overlays>
+
+#### How to read the overlay file name
+
+The overlay file name follows the following convention:
+
+    <soc-family>-<soc-variant>-<function>-<location>-<gpio-bank>-<gpio-pins>
+
+- soc-family: must be `meson`
+- soc-variant: can be one of `g12a`, or `g12b`. For Radxa Zero2, use `g12b` variant.
+- function: can be one of `i2c`, `pwm`, `spi`, or `uart`
+- location: specify the exact controller that implements the function
+- gpio-bank & gpio-pins: specify the exact GPIO pins that is muxed with the function
+
+You can specify multiple overlays in `/boot/uEnv.txt`.
+However, for any given pin they can only have 1 function,
+and for any given function they can only have 1 set of pins.
+
+For example, you cannot specify both `meson-g12b-i2c-ee-m0-gpioz-0-1`
+and `meson-g12b-i2c-ee-m0-gpioz-1-7` at the same time,
+as that assigned the same `i2c-ee-m0` function to 2 different sets of pins.
+
+#### Available overlays
+
+##### I2C
+- meson-g12b-i2c-ee-m0-gpioz-0-1
+- meson-g12b-i2c-ee-m0-gpioz-1-7
+- meson-g12b-i2c-ee-m1-gpioh-6-7
+- meson-g12b-i2c-ee-m3-gpioa-14-15
+
+##### PWM
+- meson-g12b-pwm-b-gpioh-7
+- meson-g12b-pwm-b-gpioz-0
+- meson-g12b-pwm-c-gpioz-1
+- meson-g12b-pwm-d-gpioz-2
+- meson-g12b-pwm-c-d-gpioz-1-2
+- meson-g12b-pwm-f-gpioh-5
+
+##### SPI
+- meson-g12b-spi-b-gpioh-4-5-6-7
+
+##### UART
+- meson-g12b-uart-ao-a-gpioao-0-1
+- meson-g12b-uart-ao-b-gpioao-8-9
+- meson-g12b-uart-ee-c-gpioh-4-5-6-7
\ No newline at end of file
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-fixup.scr b/arch/arm64/boot/dts/amlogic/overlays/meson-fixup.scr
new file mode 100644
index 0000000000000000000000000000000000000000..54627dca732f25185dc5b9fbba2bf3d85c88fe70
GIT binary patch
literal 863
zcmb7?Sx&<+5QZyNMQRSf^2ErkN|A`#usjv2o&p{#Cvl2JVh1l#qpA`&;RYOxBk+J2
zcLP;)^NV9==KE*n_eJgO@%!!TJ#2@kl}h!zvRI!_ALH8b(ek)uub#M{4Uh#>DJ?Z5
zd~9>jk>a`W8o;wWWf>DjLt83P)I2i<+J@S2V-3@n%T%ChWap8I6_Mdm(3G1JAy#uS
z0_%rTngtp!u7HVxD=AzO6jX5<rc47BF_0uS1R|Mbc=9}+07@C~1(4<>r;27no%5I#
zZX1SHPe~83G~v}}fg7XX0Z5lXs|A`F)CZI0Ge(Y`0nsw*AZ?H&ao4R5;s?PEevy61
z!J*{4eaY8{l5gi^oTKX$I?c)7PN$#^HC6+WFSNwoHpRIC;F#CLw-}Pq@i0;B_1BSI
z@Ie<)#m7Y7C0Zt;63G3U(JOA>mCL>QvWEY>j_^S^tAo|E*i{55HbT*$PkJ*vDtJF&
C)D?FC

literal 0
HcmV?d00001

diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-fixup.scr-cmd b/arch/arm64/boot/dts/amlogic/overlays/meson-fixup.scr-cmd
new file mode 100644
index 000000000..56fe61583
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-fixup.scr-cmd
@@ -0,0 +1,17 @@
+# overlays fixup script
+# implements (or rather substitutes) overlay arguments functionality
+# using u-boot scripting, environment variables and "fdt" command
+
+if test -n "${param_spidev_spi_bus}"; then
+	test "${param_spidev_spi_bus}" = "0" && setenv tmp_spi_path "soc/bus@ffd00000/spi@13000"
+	test "${param_spidev_spi_bus}" = "1" && setenv tmp_spi_path "soc/bus@ffd00000/spi@15000"
+	test "${param_spidev_spi_bus}" = "2" && setenv tmp_spi_path "soc/bus@ffd00000/spi@14000"
+	fdt set /${tmp_spi_path} status "okay"
+	fdt set /${tmp_spi_path}/spidev status "okay"
+	if test -n "${param_spidev_max_freq}"; then
+		fdt set /${tmp_spi_path}/spidev@0 spi-max-frequency "<${param_spidev_max_freq}>"
+	fi
+	if test "${param_spidev_spi_cs}" = "1"; then
+		fdt set /${tmp_spi_path}/spidev reg "<1>";
+	fi
+fi
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-i2c-ao-m0-gpioao-2-gpioao-3.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-i2c-ao-m0-gpioao-2-gpioao-3.dts
new file mode 100644
index 000000000..3f241cb60
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-i2c-ao-m0-gpioao-2-gpioao-3.dts
@@ -0,0 +1,15 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero", "amlogic,g12a";
+
+	fragment@0 {
+		target = <&i2c_AO>;
+		__overlay__ {
+			status = "okay";
+			pinctrl-0 = <&i2c_ao_sck_pins &i2c_ao_sda_pins>;
+			pinctrl-names = "default";
+		};
+	};
+};
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-i2c-ee-m1-gpioh-6-gpioh-7.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-i2c-ee-m1-gpioh-6-gpioh-7.dts
new file mode 100644
index 000000000..a68284bf6
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-i2c-ee-m1-gpioh-6-gpioh-7.dts
@@ -0,0 +1,15 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero", "amlogic,g12a";
+
+	fragment@0 {
+		target = <&i2c1>;
+		__overlay__ {
+			status = "okay";
+			pinctrl-0 = <&i2c1_sda_h6_pins &i2c1_sck_h7_pins>;
+			pinctrl-names = "default";
+		};
+	};
+};
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-i2c-ee-m1-gpiox-10-gpiox-11.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-i2c-ee-m1-gpiox-10-gpiox-11.dts
new file mode 100644
index 000000000..eb9c402fb
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-i2c-ee-m1-gpiox-10-gpiox-11.dts
@@ -0,0 +1,15 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero", "amlogic,g12a";
+
+	fragment@0 {
+		target = <&i2c1>;
+		__overlay__ {
+			status = "okay";
+			pinctrl-0 = <&i2c1_sda_x_pins &i2c1_sck_x_pins>;
+			pinctrl-names = "default";
+		};
+	};
+};
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-i2c-ee-m3-gpioa-14-gpioa-15.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-i2c-ee-m3-gpioa-14-gpioa-15.dts
new file mode 100644
index 000000000..12a7bc4d4
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-i2c-ee-m3-gpioa-14-gpioa-15.dts
@@ -0,0 +1,15 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero", "amlogic,g12a";
+
+	fragment@0 {
+		target = <&i2c3>;
+		__overlay__ {
+			status = "okay";
+			pinctrl-0 = <&i2c3_sck_a_pins &i2c3_sda_a_pins>;
+			pinctrl-names = "default";
+		};
+	};
+};
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-pwm-c-on-gpiox-8.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-pwm-c-on-gpiox-8.dts
new file mode 100644
index 000000000..14ca6c196
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-pwm-c-on-gpiox-8.dts
@@ -0,0 +1,17 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero", "amlogic,g12a";
+
+	fragment@0 {
+		target = <&pwm_cd>;
+		__overlay__ {
+			status = "okay";
+			pinctrl-0 = <&pwm_c_x8_pins>;
+			pinctrl-names = "default";
+			clocks = <&xtal>;
+			clock-names = "clkin2";
+		};
+	};
+};
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-pwmao-a-on-gpioao-11.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-pwmao-a-on-gpioao-11.dts
new file mode 100644
index 000000000..6edbe6222
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-pwmao-a-on-gpioao-11.dts
@@ -0,0 +1,17 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero", "amlogic,g12a";
+
+	fragment@0 {
+		target = <&pwm_AO_ab>;
+		__overlay__ {
+			status = "okay";
+			pinctrl-0 = <&pwm_ao_a_pins>;
+			pinctrl-names = "default";
+			clocks = <&xtal>;
+			clock-names = "clkin3";
+		};
+	};
+};
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-spi-spidev.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-spi-spidev.dts
new file mode 100644
index 000000000..abb23385a
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-spi-spidev.dts
@@ -0,0 +1,38 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero", "amlogic,g12a";
+
+	fragment@0 {
+		target = <&spicc0>;
+		__overlay__ {
+			pinctrl-0 = <&spicc0_x_pins &spicc0_ss0_x_pins>;
+			pinctrl-names = "default";
+			#address-cells = <1>;
+			#size-cells = <0>;
+			spidev@0 {
+				compatible = "spidev";
+				status = "disabled";
+				reg = <0>;
+				spi-max-frequency = <10000000>;
+			};
+		};
+	};
+
+	fragment@1 {
+		target = <&spicc1>;
+		__overlay__ {
+			pinctrl-0 = <&spicc1_pins &spicc1_ss0_pins>;
+			pinctrl-names = "default";
+			#address-cells = <1>;
+			#size-cells = <0>;
+			spidev@0 {
+				compatible = "spidev";
+				status = "disabled";
+				reg = <0>;
+				spi-max-frequency = <10000000>;
+			};
+		};
+	};
+};
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-uart-ao-a-on-gpioao-0-gpioao-1.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-uart-ao-a-on-gpioao-0-gpioao-1.dts
new file mode 100644
index 000000000..350448d20
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-uart-ao-a-on-gpioao-0-gpioao-1.dts
@@ -0,0 +1,15 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero", "amlogic,g12a";
+
+	fragment@0 {
+		target = <&uart_AO>;
+		__overlay__ {
+			status = "okay";
+			pinctrl-0 = <&uart_ao_a_pins>;
+			pinctrl-names = "default";
+		};
+	};
+};
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-uart-ao-b-on-gpioao-2-gpioao-3.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-uart-ao-b-on-gpioao-2-gpioao-3.dts
new file mode 100644
index 000000000..5a93fedd6
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-uart-ao-b-on-gpioao-2-gpioao-3.dts
@@ -0,0 +1,15 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero", "amlogic,g12a";
+
+	fragment@0 {
+		target = <&uart_AO_B>;
+		__overlay__ {
+			status = "okay";
+			pinctrl-0 = <&uart_ao_b_tx_2_rx_3_pins>;
+			pinctrl-names = "default";
+		};
+	};
+};
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-uart-ao-b-on-gpioao-8-gpioao-9.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-uart-ao-b-on-gpioao-8-gpioao-9.dts
new file mode 100644
index 000000000..a4afad9f5
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-uart-ao-b-on-gpioao-8-gpioao-9.dts
@@ -0,0 +1,15 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero", "amlogic,g12a";
+
+	fragment@0 {
+		target = <&uart_AO_B>;
+		__overlay__ {
+			status = "okay";
+			pinctrl-0 = <&uart_ao_b_tx_8_rx_9_pins>;
+			pinctrl-names = "default";
+		};
+	};
+};
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-uart-ee-c.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-uart-ee-c.dts
new file mode 100644
index 000000000..afcf79eea
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-uart-ee-c.dts
@@ -0,0 +1,15 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero", "amlogic,g12a";
+
+	fragment@0 {
+		target = <&uart_C>;
+		__overlay__ {
+			status = "okay";
+			pinctrl-0 = <&uart_c_pins &uart_c_cts_rts_pins>;
+			pinctrl-names = "default";
+		};
+	};
+};
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-w1-gpioao-3.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-w1-gpioao-3.dts
new file mode 100644
index 000000000..75df4259d
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12a-w1-gpioao-3.dts
@@ -0,0 +1,20 @@
+/dts-v1/;
+/plugin/;
+
+#include <dt-bindings/gpio/gpio.h>
+#include <dt-bindings/gpio/meson-g12a-gpio.h>
+
+/ {
+	compatible = "radxa,zero", "amlogic,g12a";
+
+	fragment@0 {
+		target-path = "/";
+		__overlay__ {
+			w1: onewire {
+				compatible = "w1-gpio";
+				gpios = <&gpio_ao GPIOAO_3 GPIO_ACTIVE_HIGH>;
+				status = "okay";
+			};
+		};
+	};
+};
\ No newline at end of file
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-i2c-ee-m0-gpioz-0-1.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-i2c-ee-m0-gpioz-0-1.dts
new file mode 100644
index 000000000..d75240bd6
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-i2c-ee-m0-gpioz-0-1.dts
@@ -0,0 +1,15 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero2", "amlogic,a311d", "amlogic,g12b";
+
+	fragment@0 {
+		target = <&i2c0>;
+		__overlay__ {
+			status = "okay";
+			pinctrl-0 = <&i2c0_sck_z1_pins &i2c0_sda_z0_pins>;
+			pinctrl-names = "default";
+		};
+	};
+};
\ No newline at end of file
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-i2c-ee-m0-gpioz-1-7.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-i2c-ee-m0-gpioz-1-7.dts
new file mode 100644
index 000000000..14a78efce
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-i2c-ee-m0-gpioz-1-7.dts
@@ -0,0 +1,15 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero2", "amlogic,a311d", "amlogic,g12b";
+
+	fragment@0 {
+		target = <&i2c0>;
+		__overlay__ {
+			status = "okay";
+			pinctrl-0 = <&i2c0_sck_z1_pins &i2c0_sda_z7_pins>;
+			pinctrl-names = "default";
+		};
+	};
+};
\ No newline at end of file
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-i2c-ee-m1-gpioh-6-7.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-i2c-ee-m1-gpioh-6-7.dts
new file mode 100644
index 000000000..2622068fb
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-i2c-ee-m1-gpioh-6-7.dts
@@ -0,0 +1,15 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero2", "amlogic,a311d", "amlogic,g12b";
+
+	fragment@0 {
+		target = <&i2c1>;
+		__overlay__ {
+			status = "okay";
+			pinctrl-0 = <&i2c1_sck_h7_pins &i2c1_sda_h6_pins>;
+			pinctrl-names = "default";
+		};
+	};
+};
\ No newline at end of file
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-i2c-ee-m3-gpioa-14-15.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-i2c-ee-m3-gpioa-14-15.dts
new file mode 100644
index 000000000..689d856da
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-i2c-ee-m3-gpioa-14-15.dts
@@ -0,0 +1,15 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero2", "amlogic,a311d", "amlogic,g12b";
+
+	fragment@0 {
+		target = <&i2c3>;
+		__overlay__ {
+			status = "okay";
+			pinctrl-0 = <&i2c3_sck_a_pins &i2c3_sda_a_pins>;
+			pinctrl-names = "default";
+		};
+	};
+};
\ No newline at end of file
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-b-gpioh-7.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-b-gpioh-7.dts
new file mode 100644
index 000000000..51de7436b
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-b-gpioh-7.dts
@@ -0,0 +1,17 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero2", "amlogic,a311d", "amlogic,g12b";
+
+	fragment@0 {
+		target = <&pwm_ab>;
+		__overlay__ {
+			pinctrl-0 = <&pwm_a_e_pins &pwm_b_h_pins>;
+			pinctrl-names = "default";
+			clocks = <&xtal>;
+			clock-names = "clkin0";
+			status = "okay";
+		};
+	};
+};
\ No newline at end of file
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-b-gpioz-0.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-b-gpioz-0.dts
new file mode 100644
index 000000000..ab07167ee
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-b-gpioz-0.dts
@@ -0,0 +1,17 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero2", "amlogic,a311d", "amlogic,g12b";
+
+	fragment@0 {
+		target = <&pwm_ab>;
+		__overlay__ {
+			pinctrl-0 = <&pwm_a_e_pins &pwm_b_z_pins>;
+			pinctrl-names = "default";
+			clocks = <&xtal>;
+			clock-names = "clkin0";
+			status = "okay";
+		};
+	};
+};
\ No newline at end of file
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-c-d-gpioz-1-2.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-c-d-gpioz-1-2.dts
new file mode 100644
index 000000000..579e8417b
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-c-d-gpioz-1-2.dts
@@ -0,0 +1,17 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero2", "amlogic,a311d", "amlogic,g12b";
+
+	fragment@0 {
+		target = <&pwm_cd>;
+		__overlay__ {
+			pinctrl-0 = <&pwm_c_z1_pins &pwm_d_z_pins>;
+			pinctrl-names = "default";
+			clocks = <&xtal>;
+			clock-names = "clkin1";
+			status = "okay";
+		};
+	};
+};
\ No newline at end of file
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-c-gpioz-1.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-c-gpioz-1.dts
new file mode 100644
index 000000000..419d38b76
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-c-gpioz-1.dts
@@ -0,0 +1,17 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero2", "amlogic,a311d", "amlogic,g12b";
+
+	fragment@0 {
+		target = <&pwm_cd>;
+		__overlay__ {
+			pinctrl-0 = <&pwm_c_z_pins>;
+			pinctrl-names = "default";
+			clocks = <&xtal>;
+			clock-names = "clkin1";
+			status = "okay";
+		};
+	};
+};
\ No newline at end of file
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-d-gpioz-2.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-d-gpioz-2.dts
new file mode 100644
index 000000000..961077d34
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-d-gpioz-2.dts
@@ -0,0 +1,17 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero2", "amlogic,a311d", "amlogic,g12b";
+
+	fragment@0 {
+		target = <&pwm_cd>;
+		__overlay__ {
+			pinctrl-0 = <&pwm_d_z_pins>;
+			pinctrl-names = "default";
+			clocks = <&xtal>;
+			clock-names = "clkin1";
+			status = "okay";
+		};
+	};
+};
\ No newline at end of file
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-f-gpioh-5.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-f-gpioh-5.dts
new file mode 100644
index 000000000..7d1723137
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-pwm-f-gpioh-5.dts
@@ -0,0 +1,17 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero2", "amlogic,a311d", "amlogic,g12b";
+
+	fragment@0 {
+		target = <&pwm_ef>;
+		__overlay__ {
+			pinctrl-0 = <&pwm_e_pins &pwm_f_h_pins>;
+			pinctrl-names = "default";
+			clocks = <&xtal>;
+			clock-names = "clkin2";
+			status = "okay";
+		};
+	};
+};
\ No newline at end of file
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-spi-b-gpioh-4-5-6-7.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-spi-b-gpioh-4-5-6-7.dts
new file mode 100644
index 000000000..605f0ec65
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-spi-b-gpioh-4-5-6-7.dts
@@ -0,0 +1,23 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero2", "amlogic,a311d", "amlogic,g12b";
+
+	fragment@0 {
+		target = <&spicc1>;
+		__overlay__ {
+			pinctrl-0 = <&spicc1_pins &spicc1_ss0_pins>;
+			pinctrl-names = "default";
+			#address-cells = <1>;
+			#size-cells = <0>;
+            status = "okay";
+			spidev@0 {
+				compatible = "linux,spidev";
+				status = "okay";
+				spi-max-frequency = <10000000>;
+				reg = <0>;
+			};
+		};
+	};
+};
\ No newline at end of file
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-uart-ao-a-gpioao-0-1.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-uart-ao-a-gpioao-0-1.dts
new file mode 100644
index 000000000..4a0ff41cc
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-uart-ao-a-gpioao-0-1.dts
@@ -0,0 +1,15 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero2", "amlogic,a311d", "amlogic,g12b";
+
+	fragment@0 {
+		target = <&uart_AO>;
+		__overlay__ {
+			status = "okay";
+			pinctrl-0 = <&uart_ao_a_pins>;
+			pinctrl-names = "default";
+		};
+	};
+};
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-uart-ao-b-gpioao-8-9.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-uart-ao-b-gpioao-8-9.dts
new file mode 100644
index 000000000..72f79f4dc
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-uart-ao-b-gpioao-8-9.dts
@@ -0,0 +1,15 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero2", "amlogic,a311d", "amlogic,g12b";
+
+	fragment@0 {
+		target = <&uart_AO_B>;
+		__overlay__ {
+			status = "okay";
+			pinctrl-0 = <&uart_ao_b_tx_8_rx_9_pins>;
+			pinctrl-names = "default";
+		};
+	};
+};
\ No newline at end of file
diff --git a/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-uart-ee-c-gpioh-4-5-6-7.dts b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-uart-ee-c-gpioh-4-5-6-7.dts
new file mode 100644
index 000000000..5ab6ab8ca
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlays/meson-g12b-uart-ee-c-gpioh-4-5-6-7.dts
@@ -0,0 +1,15 @@
+/dts-v1/;
+/plugin/;
+
+/ {
+	compatible = "radxa,zero2", "amlogic,a311d", "amlogic,g12b";
+
+	fragment@0 {
+		target = <&uart_C>;
+		__overlay__ {
+			status = "okay";
+			pinctrl-0 = <&uart_c_pins &uart_c_cts_rts_pins>;
+			pinctrl-names = "default";
+		};
+	};
+};
\ No newline at end of file
-- 
2.36.1

